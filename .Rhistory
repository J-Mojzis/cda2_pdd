geom_histogram(bins = 3) +
geom_text()
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_histogram() +
geom_text()
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text()
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text(label=n)
rf
rf <- svd_10 %>% count(d1e2)
ggplot(svd_10, aes(d1e2, svd_10 %>% count(d1e2)$n)) +
geom_col() +
geom_text(label=n)
rf <- svd_10 %>% count(d1e2)
ggplot(svd_10, aes(d1e2, svd_10 %>% count(d1e2) %>% n)) +
geom_col() +
geom_text(label=n)
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text(label=n)
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=3)
ggplot(svd_10, aes(d1e3)) +
geom_histogram()
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(svd_10, aes(d1e3)) +
geom_histogram()
rf <- svd_10 %>% count(d1e2)
ggplot(rf, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(svd_10, aes(d1e3)) +
geom_histogram(bins = 21)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e2)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(svd_10, aes(d1e3)) +
geom_histogram(bins = 21)
rf_3
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(svd_10, aes(d1e3)) +
geom_histogram(bins = 21)
rf_3
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
View(svd)
#erstellen einer Spalte nur mit dem Datum als Jahr
year <- format(as.Date(svd$datum, format='%d.%m.%Y'), format="%Y")
mutate(svd, jahr=year)
svd <- svd %>% mutate(datum = as.Date(datum, format = "%d.%m.%y"))
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
theme_minimal()+
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
labs(x="Abstimmungsjahr", y="Abstimmungsresultat")+
geom_vline(xintercept = "1971", colour = 'grey') +
geom_text(aes(x='1971', label='Vor und', y="."), colour = 'blue', angle=90, vjust=-1.2, text=element_text(size = 3)) +
geom_text(aes(x='1971', label='Nach 1971-Frauenstimmrecht', y="0"), colour = 'hotpink', angle=90, vjust=1.2, text=element_text(size = 3))
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
facet_grid(rows = vars(d1e1)) +
geom_vline(xintercept = c("1971","1910"), colour = 'red')
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
facet_grid(rows = vars(dep)) +
geom_vline(xintercept = "1971", colour = 'red')
ber1_w <- svd %>% count(d1e1, year>="1971")
ber1_w
ggplot(ber1_w, aes(reorder(d1e1, desc(n)), n)) +
geom_col()+
geom_label(aes(label=n), vjust=-0.1, size=3)
ggplot(ber1_w, aes(reorder(d1e1, desc(n)), n, fill=`year >= "1971"`)) +
geom_col(position = position_dodge()) +
geom_label(aes(label=n), vjust=-0.1, size=3)+
scale_fill_discrete(labels = c("Vor 1971 ", "Nach 1971"))+
labs(title = "Abstimmungen pro Politikbereich vor und nach 1971\n(Frauenstimmrecht)", x="Politikbereich", y="Anzahl Abstimungen", fill="Anzahl\nAbstimmungen")
dat <- svd %>% select(datum)
svd_r <- svd %>% select(c(anzahl, rechtsform, d1e1, d1e2, d1e3, dep, "br-pos", legislatur, "bv-pos", "nr-pos", nrja, nrnein, "sr-pos", srja, srnein, "dat-force", dauer_bv, sammelfrist, unter_g, "p-fdp":"p-bpuk", "w-fdp":"w-ubrige", "ja-lager", "nein-lager", "keinepar-summe", "leer-summe", "freigabe-summe", "neutral-summe", "unbekannt-summe", "inserate-ja", "inserate-nein", "inserate-jaanteil", "mediares-tot", "mediares-d", "mediares-f", "mediaton-tot", "mediaton-d", "mediaton-f", volk, stand, annahme, bet, ungultig, gultig, "volkja-proz", "kt-ja", "kt-nein", ktjaproz, matches("..-bet"), matches("..-japroz"), matches("..-annahme")))
svd_n <- lapply(svd_r,as.numeric)
svd_n <- bind_cols(as.Date(svd$datum, format='%d.%m.%Y'), svd_n) #Datumformat korrigieren
svd_n <- rename(svd_n, "datum" = "...1") #Unbenennen der Datumvariable
skim(svd_n) #shows big summary with stats
dat <- svd %>% select(datum)
svd_r <- svd %>% select(c(anzahl, rechtsform, d1e1, d1e2, d1e3, dep, "br-pos", legislatur, "bv-pos", "nr-pos", nrja, nrnein, "sr-pos", srja, srnein, "dat-force", dauer_bv, sammelfrist, unter_g, "p-fdp":"p-bpuk", "w-fdp":"w-ubrige", "ja-lager", "nein-lager", "keinepar-summe", "leer-summe", "freigabe-summe", "neutral-summe", "unbekannt-summe", "inserate-ja", "inserate-nein", "inserate-jaanteil", "mediares-tot", "mediares-d", "mediares-f", "mediaton-tot", "mediaton-d", "mediaton-f", volk, stand, annahme, bet, ungultig, gultig, "volkja-proz", "kt-ja", "kt-nein", ktjaproz, matches("..-bet"), matches("..-japroz"), matches("..-annahme")))
svd_n <- lapply(svd_r,as.numeric)
svd_n <- bind_cols(svd$datum, svd_n) #Datumformat korrigieren
svd_n <- rename(svd_n, "datum" = "...1") #Unbenennen der Datumvariable
skim(svd_n) #shows big summary with stats
dat <- svd %>% select(datum)
svd_r <- svd %>% select(c(anzahl, rechtsform, d1e1, d1e2, d1e3, dep, "br-pos", legislatur, "bv-pos", "nr-pos", nrja, nrnein, "sr-pos", srja, srnein, "dat-force", dauer_bv, sammelfrist, unter_g, "p-fdp":"p-bpuk", "w-fdp":"w-ubrige", "ja-lager", "nein-lager", "keinepar-summe", "leer-summe", "freigabe-summe", "neutral-summe", "unbekannt-summe", "inserate-ja", "inserate-nein", "inserate-jaanteil", "mediares-tot", "mediares-d", "mediares-f", "mediaton-tot", "mediaton-d", "mediaton-f", volk, stand, annahme, bet, ungultig, gultig, "volkja-proz", "kt-ja", "kt-nein", ktjaproz, matches("..-bet"), matches("..-japroz"), matches("..-annahme")))
svd_n <- lapply(svd_r,as.numeric)
svd_n <- bind_cols(svd$datum, svd_n)
#Unbenennen der Datumvariable
skim(svd_n) #shows big summary with stats
dat <- svd %>% select(datum)
svd_r <- svd %>% select(c(anzahl, rechtsform, d1e1, d1e2, d1e3, dep, "br-pos", legislatur, "bv-pos", "nr-pos", nrja, nrnein, "sr-pos", srja, srnein, "dat-force", dauer_bv, sammelfrist, unter_g, "p-fdp":"p-bpuk", "w-fdp":"w-ubrige", "ja-lager", "nein-lager", "keinepar-summe", "leer-summe", "freigabe-summe", "neutral-summe", "unbekannt-summe", "inserate-ja", "inserate-nein", "inserate-jaanteil", "mediares-tot", "mediares-d", "mediares-f", "mediaton-tot", "mediaton-d", "mediaton-f", volk, stand, annahme, bet, ungultig, gultig, "volkja-proz", "kt-ja", "kt-nein", ktjaproz, matches("..-bet"), matches("..-japroz"), matches("..-annahme")))
svd_n <- lapply(svd_r,as.numeric)
svd_n <- bind_cols(svd$datum, svd_n)
svd_n <- rename(svd_n, "datum" = "...1") #Unbenennen der Datumvariable
skim(svd_n) #shows big summary with stats
svd_rr <-  svd_n[,!sapply(svd_n, function(x) mean(is.na(x)))>0.9 ] #nehmen nur Variablen denen nicht mehr als 90% der Daten fehlen.
#skim(svd_rr)
svd_na <- svd_rr %>%
replace_with_na_all(condition = ~.x == 9999) #Ersetzen alle Observationen welche 9999 haben (zu dieser Zeit nicht existieren) mit NA. Damit haben wir ein besseres Bild wie die Variable organisiert ist.
svd_2_3 <- filter(svd_na, d1e1 == 2 | d1e1 == 3) #nehmen die Observationen, welche dem Politikbereich 2 oder 3 angehören
svd_2_3 <-  svd_2_3[,!sapply(svd_2_3, function(x) mean(is.na(x)))>0.883 ]  #nehmen nur Variablen denen nicht mehr als 88.3%% der Daten fehlen. Wert von Mediaton
dim(svd_2_3)
svd_10 <- filter(svd_na, d1e1 == 10) #nehmen die Observationen, welche dem Politikbereich 10 angehören
svd_10 <-  svd_10[,!sapply(svd_10, function(x) mean(is.na(x)))>0.804 ] #80.4% Wert von Mediaton
dim(svd_10)
skim(svd_2_3)
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram(binwidth = 1) +
labs(title = "svd_2_3")
ggplot(svd_10, aes(rechtsform)) +
geom_histogram(binwidth = 1) +
labs(title = "svd_10")
#geom_text(aes(label=n), vjust=-0.1, size=3)
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()
dep_10 <- svd_10 %>% count(dep)
dep_23 <- svd_2_3 %>% count(dep)
ggplot(dep_10, aes(dep, n)) +
geom_col()
ggplot(dep_23, aes(dep, n)) +
geom_col()
dep_10 <- svd_10 %>% count(dep)
dep_23 <- svd_2_3 %>% count(dep)
ggplot(dep_10, aes(dep, n)) +
geom_col()+
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(dep_23, aes(dep, n)) +
geom_col()+
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3") +
scale_x_date(date_breaks = "5 years", date_labels = "%m.%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3") +
scale_y_date(date_breaks = "5 years", date_labels = "%m.%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3") +
scale_y_date(date_breaks = "10 years", date_labels = "%m.%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3") +
scale_y_date(date_breaks = "50 years", date_labels = "%m.%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3") +
scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3")
#scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(datum, rechtsform)) +
geom_col() +
labs(title = "svd_2_3")
#scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(datum, rechtsform)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_2_3")
#scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(rechtsform, datum)) +
geom_col() +
labs(title = "svd_10")
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram() +
labs(title = "svd_2_3") +
facet_wrap(datum)
View(svd_2_3)
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram() +
facet_wrap(datum) +
labs(title = "svd_2_3")
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram()
labs(title = "svd_2_3")
#scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(rechtsform)) +
geom_histogram() +
labs(title = "svd_10")
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=x), vjust=-0.1, size=5)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e2), vjust=-0.1, size=5)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=5)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=0.3, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=2.3, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=1.3, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=-1.3, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=-1, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=-0.8, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=0.8, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=0.9, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_label(aes(label=n), vjust=1.2, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_text(aes(label=n), vjust=1.2, size=3)
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_text(aes(label=n), vjust=1.2, size=3, colour = "white")
library(tidyverse)
library(dplyr)
library(tidyr)
library(skimr)
library(naniar)
svd <- read_csv2("swissvotes_dataset.csv")
pol_ber <- svd %>% count(d1e1, sort = TRUE)
pol_ber
ggplot(pol_ber, aes(reorder(d1e1, desc(n)), n)) +
geom_bar(stat="identity") +
theme_minimal() +
labs(x="Politikbereich", y="Anzahl Abstimungen")+
geom_text(aes(label=n), vjust=-0.3, size=3.5)
#erstellen einer Spalte nur mit dem Datum als Jahr
year <- format(as.Date(svd$datum, format='%d.%m.%Y'), format="%Y")
mutate(svd, jahr=year)
svd <- svd %>% mutate(datum = as.Date(datum, format = "%d.%m.%y"))
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
theme_minimal()+
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
labs(x="Abstimmungsjahr", y="Abstimmungsresultat")+
geom_vline(xintercept = "1971", colour = 'grey') +
geom_text(aes(x='1971', label='Vor und', y="."), colour = 'blue', angle=90, vjust=-1.2, text=element_text(size = 3)) +
geom_text(aes(x='1971', label='Nach 1971-Frauenstimmrecht', y="0"), colour = 'hotpink', angle=90, vjust=1.2, text=element_text(size = 3))
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
facet_grid(rows = vars(d1e1)) +
geom_vline(xintercept = c("1971","1910"), colour = 'red')
ggplot(svd, aes(year, annahme)) +
geom_jitter() +
facet_grid(rows = vars(dep)) +
geom_vline(xintercept = "1971", colour = 'red')
ber1_w <- svd %>% count(d1e1, year>="1971")
ber1_w
ggplot(ber1_w, aes(reorder(d1e1, desc(n)), n)) +
geom_col()+
geom_label(aes(label=n), vjust=-0.1, size=3)
ggplot(ber1_w, aes(reorder(d1e1, desc(n)), n, fill=`year >= "1971"`)) +
geom_col(position = position_dodge()) +
geom_label(aes(label=n), vjust=-0.1, size=3)+
scale_fill_discrete(labels = c("Vor 1971 ", "Nach 1971"))+
labs(title = "Abstimmungen pro Politikbereich vor und nach 1971\n(Frauenstimmrecht)", x="Politikbereich", y="Anzahl Abstimungen", fill="Anzahl\nAbstimmungen")
dat <- svd %>% select(datum)
svd_r <- svd %>% select(c(anzahl, rechtsform, d1e1, d1e2, d1e3, dep, "br-pos", legislatur, "bv-pos", "nr-pos", nrja, nrnein, "sr-pos", srja, srnein, "dat-force", dauer_bv, sammelfrist, unter_g, "p-fdp":"p-bpuk", "w-fdp":"w-ubrige", "ja-lager", "nein-lager", "keinepar-summe", "leer-summe", "freigabe-summe", "neutral-summe", "unbekannt-summe", "inserate-ja", "inserate-nein", "inserate-jaanteil", "mediares-tot", "mediares-d", "mediares-f", "mediaton-tot", "mediaton-d", "mediaton-f", volk, stand, annahme, bet, ungultig, gultig, "volkja-proz", "kt-ja", "kt-nein", ktjaproz, matches("..-bet"), matches("..-japroz"), matches("..-annahme")))
svd_n <- lapply(svd_r,as.numeric)
svd_n <- bind_cols(svd$datum, svd_n)
svd_n <- rename(svd_n, "datum" = "...1") #Unbenennen der Datumvariable
skim(svd_n) #shows big summary with stats
svd_rr <-  svd_n[,!sapply(svd_n, function(x) mean(is.na(x)))>0.9 ] #nehmen nur Variablen denen nicht mehr als 90% der Daten fehlen.
#skim(svd_rr)
svd_na <- svd_rr %>%
replace_with_na_all(condition = ~.x == 9999) #Ersetzen alle Observationen welche 9999 haben (zu dieser Zeit nicht existieren) mit NA. Damit haben wir ein besseres Bild wie die Variable organisiert ist.
svd_2_3 <- filter(svd_na, d1e1 == 2 | d1e1 == 3) #nehmen die Observationen, welche dem Politikbereich 2 oder 3 angehören
svd_2_3 <-  svd_2_3[,!sapply(svd_2_3, function(x) mean(is.na(x)))>0.883 ]  #nehmen nur Variablen denen nicht mehr als 88.3%% der Daten fehlen. Wert von Mediaton
dim(svd_2_3)
svd_10 <- filter(svd_na, d1e1 == 10) #nehmen die Observationen, welche dem Politikbereich 10 angehören
svd_10 <-  svd_10[,!sapply(svd_10, function(x) mean(is.na(x)))>0.804 ] #80.4% Wert von Mediaton
dim(svd_10)
skim(svd_2_3)
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram(binwidth = 1) +
labs(title = "svd_2_3")
ggplot(svd_10, aes(rechtsform)) +
geom_histogram(binwidth = 1) +
labs(title = "svd_10")
#geom_text(aes(label=n), vjust=-0.1, size=3)
ggplot(svd_2_3, aes(rechtsform)) +
geom_histogram()
labs(title = "svd_2_3")
#scale_y_date(date_breaks = "100 years", date_labels = "%Y")
ggplot(svd_10, aes(rechtsform)) +
geom_histogram() +
labs(title = "svd_10")
rf_2 <- svd_10 %>% count(d1e2)
rf_3 <- svd_10 %>% count(d1e3)
ggplot(rf_2, aes(d1e2, n)) +
geom_col() +
labs(x="Rechtsform", y = "Anzahl")
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(rf_3, aes(d1e3, n)) +
geom_col()+
labs(x="Rechtsform", y = "Anzahl")+
geom_text(aes(label=d1e3), vjust=-0.1, size=3) +
geom_text(aes(label=n), vjust=1.2, size=3, colour = "white")
dep_10 <- svd_10 %>% count(dep)
dep_23 <- svd_2_3 %>% count(dep)
ggplot(dep_10, aes(dep, n)) +
geom_col()+
geom_text(aes(label=n), vjust=-0.1, size=5)
ggplot(dep_23, aes(dep, n)) +
geom_col()+
geom_text(aes(label=n), vjust=-0.1, size=5)
View(svd)
